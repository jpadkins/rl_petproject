///////////////////////////////////////////////////////////////////////////////
/// @file   log.h
/// @brief  Provides an API for logging and halting execution if necessary
/// @author Jacob Adkins (jpadkins)
///////////////////////////////////////////////////////////////////////////////

#ifndef LOG_H
#define LOG_H

///////////////////////////////////////////////////////////////////////////////
/// Headers
///////////////////////////////////////////////////////////////////////////////
#include <stdarg.h>

///////////////////////////////////////////////////////////////////////////////
/// @brief LogLevel is the severity of the logged message
///
/// LOG_INFO: Logs the message with the [INFO] tag
/// LOG_WARN: Logs the message with the [WARN] tag - more severe
/// LOG_EXIT: Logs the message with the [EXIT] tag and halts execution
///////////////////////////////////////////////////////////////////////////////
typedef enum {LOG_INFO, LOG_WARN, LOG_EXIT} LogLevel;

///////////////////////////////////////////////////////////////////////////////
/// @brief Used internally by the macros - do not call
///////////////////////////////////////////////////////////////////////////////
void debug_log(LogLevel level, const char *file, const char *func, int line,
    const char *msg, ...);

///////////////////////////////////////////////////////////////////////////////
/// @brief Logs a message with a severity level
///
/// @param level    LogLevel corresponding with the severity of the message
/// @param msg      const char * containing the message to log
///////////////////////////////////////////////////////////////////////////////
#define LOG(level,msg) debug_log(level,__FILE__,__func__,__LINE__,msg)

///////////////////////////////////////////////////////////////////////////////
/// @brief Logs a formatted message with a severity level
///
/// The formatted string can be at most 1024 chars.
///
/// @param level    LogLevel corresponding with the severity of the message
/// @param msg      const char * containing the format string
/// @param ...      arguments to be formatted into msg
///////////////////////////////////////////////////////////////////////////////
#define LOGFMT(level,msg,...) debug_log(level,__FILE__,__func__,__LINE__,\
    msg,__VA_ARGS__);

#endif

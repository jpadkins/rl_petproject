///////////////////////////////////////////////////////////////////////////////
/// @file   debug.h
/// @brief  Provides an API for logging and halting execution if necessary
/// @author Jacob Adkins (jpadkins)
///////////////////////////////////////////////////////////////////////////////

#ifndef DEBUG_LOG_H
#define DEBUG_LOG_H

///////////////////////////////////////////////////////////////////////////////
/// Headers
///////////////////////////////////////////////////////////////////////////////
#include <stdarg.h>

///////////////////////////////////////////////////////////////////////////////
/// @brief DebugLevel is the severity of the logged message
///
/// DEBUG_INFO: Logs the message with the [INFO] tag
/// DEBUG_WARN: Logs the message with the [WARN] tag - more severe
/// DEBUG_EXIT: Logs the message with the [EXIT] tag and halts execution
///////////////////////////////////////////////////////////////////////////////
typedef enum {DEBUG_INFO, DEBUG_WARN, DEBUG_EXIT} DebugLevel;

///////////////////////////////////////////////////////////////////////////////
/// @brief Used internally by the macros - do not call
///////////////////////////////////////////////////////////////////////////////
void debug_log(DebugLevel level, const char *file, const char *func, int line,
    const char *msg, ...);

///////////////////////////////////////////////////////////////////////////////
/// @brief Logs a message with a severity level
///
/// @param level    DebugLevel corresponding with the severity of the message
/// @param msg      const char * containing the message to log
///////////////////////////////////////////////////////////////////////////////
#define DEBUG(level,msg) debug_log(level,__FILE__,__func__,__LINE__,msg)

///////////////////////////////////////////////////////////////////////////////
/// @brief Logs a formatted message with a severity level
///
/// The formatted string can be at most 1024 chars.
///
/// @param level    DebugLevel corresponding with the severity of the message
/// @param msg      const char * containing the format string
/// @param ...      arguments to be formatted into msg
///////////////////////////////////////////////////////////////////////////////
#define DEBUGFMT(level,msg,...) debug_log(level,__FILE__,__func__,__LINE__,\
    msg,__VA_ARGS__);

#endif
